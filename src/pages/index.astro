---
import Download from "../components/Download.tsx";
import FAQPreview from "../components/FAQPreview.astro";
import Features from "../components/Features.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";
import Hero from "../components/Hero.astro";
import Insights from "../components/Insights.astro";
import Screenshots from "../components/Screenshots.astro";
import Usage from "../components/Usage.astro";
import { fetchLatestRelease } from "../funcs/fetchReleaseData.ts";
import { getLangFromUrl, useTranslations } from "../i18n/utils";
import Layout from "../layouts/Layout.astro";
import type { PlatformDownload } from "../types/platform";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const release = await fetchLatestRelease();

const downloads: PlatformDownload[] = [
  {
    platform: "Windows",
    versions: [
      {
        type: "windows",
        name: "Windows 10/11 (x64)",
        url: release.platforms.windows?.browser_download_url ?? null,
        size: release.platforms.windows?.size ?? "-",
      },
    ],
    primary: false,
  },
  {
    platform: "Linux",
    versions: [
      {
        type: "linuxRPM",
        name: "RPM-based Distros (.rpm)",
        url: release.platforms.linuxRPM?.browser_download_url ?? null,
        size: release.platforms.linuxRPM?.size ?? "-",
      },
      {
        type: "linuxAppImage",
        name: "AppImage (.AppImage)",
        url: release.platforms.linuxAppImage?.browser_download_url ?? null,
        size: release.platforms.linuxAppImage?.size ?? "-",
      },
      {
        type: "linuxDeb",
        name: "Debian/Ubuntu (.deb)",
        url: release.platforms.linuxDeb?.browser_download_url ?? null,
        size: release.platforms.linuxDeb?.size ?? "-",
      },
    ],
    primary: false,
  },
];

const downloadTranslations = {
  title: t("download.title"),
  description: t("download.description"),
  currentVersion: t("download.currentVersion"),
  button: t("download.button"),
  noDownloads: t("download.noDownloads"),
  otherVersions: t("download.otherVersions"),
  githubLink: t("download.githubLink"),
};

// SoftwareApplication JSON-LD for rich search results
const softwareJsonLd = {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  name: "HardwareVisualizer",
  applicationCategory: "UtilitiesApplication",
  operatingSystem: "Windows 10, Windows 11, Linux",
  url: "https://hardviz.com/",
  downloadUrl: "https://github.com/shm11C3/HardwareVisualizer/releases",
  softwareVersion: release.version,
  description:
    "Free, lightweight, and open-source hardware monitoring tool. Track CPU temperature, GPU usage, memory allocation, and system performance in real-time with beautiful graphs.",
  featureList: [
    "Real-time CPU monitoring with per-core statistics",
    "GPU temperature and utilization tracking",
    "Memory usage analysis",
    "30-day historical data and trend visualization",
    "Process tracking for high CPU/GPU usage",
    "Custom dashboard with wallpaper support",
    "Lightweight Tauri/Rust architecture",
  ],
  screenshot: "https://hardviz.com/screenshots/slide-1.png",
  author: {
    "@type": "Person",
    name: "shm11C3",
    url: "https://github.com/shm11C3",
  },
  offers: {
    "@type": "Offer",
    price: "0",
    priceCurrency: "USD",
  },
  license: "https://opensource.org/licenses/MIT",
};
---

<Layout
  title="HardwareVisualizer - Free Lightweight CPU, GPU & Memory Monitor for Windows/Linux"
  lang={lang}
  description="Free open-source hardware monitoring tool for Windows and Linux. Track CPU temperature, GPU usage, memory in real-time with beautiful graphs. Lightweight alternative to HWiNFO and Task Manager."
  jsonLd={softwareJsonLd}
>
  <Header />
  <main>
    <Hero />
    <Screenshots />
    <Usage />
    <Insights />
    <Features />
    <Download
      client:visible
      downloads={downloads}
      latestVersion={release.version}
      translations={downloadTranslations}
    />
    <FAQPreview />
  </main>
  <Footer />
</Layout>
