---
import Download from "../../components/Download";
import FAQPreview from "../../components/FAQPreview.astro";
import Features from "../../components/Features.astro";
import Footer from "../../components/Footer.astro";
import Header from "../../components/Header.astro";
import Hero from "../../components/Hero.astro";
import Insights from "../../components/Insights.astro";
import Screenshots from "../../components/Screenshots.astro";
import Usage from "../../components/Usage.astro";
import { fetchLatestRelease } from "../../funcs/fetchReleaseData.ts";
import { getLangFromUrl, useTranslations } from "../../i18n/utils";
import Layout from "../../layouts/Layout.astro";
import type { PlatformDownload } from "../../types/platform";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const release = await fetchLatestRelease();

const downloads: PlatformDownload[] = [
  {
    platform: "Windows",
    versions: [
      {
        type: "windows",
        name: "Windows 10/11 (x64)",
        url: release.platforms.windows?.browser_download_url ?? null,
        size: release.platforms.windows?.size ?? "-",
      },
    ],
    primary: false,
  },
  {
    platform: "Linux",
    versions: [
      {
        type: "linuxRPM",
        name: "RPM-based Distros (.rpm)",
        url: release.platforms.linuxRPM?.browser_download_url ?? null,
        size: release.platforms.linuxRPM?.size ?? "-",
      },
      {
        type: "linuxAppImage",
        name: "AppImage (.AppImage)",
        url: release.platforms.linuxAppImage?.browser_download_url ?? null,
        size: release.platforms.linuxAppImage?.size ?? "-",
      },
      {
        type: "linuxDeb",
        name: "Debian/Ubuntu (.deb)",
        url: release.platforms.linuxDeb?.browser_download_url ?? null,
        size: release.platforms.linuxDeb?.size ?? "-",
      },
    ],
    primary: false,
  },
];

const downloadTranslations = {
  title: t("download.title"),
  description: t("download.description"),
  currentVersion: t("download.currentVersion"),
  button: t("download.button"),
  noDownloads: t("download.noDownloads"),
  otherVersions: t("download.otherVersions"),
  githubLink: t("download.githubLink"),
};

// SoftwareApplication JSON-LD for rich search results (Japanese)
const softwareJsonLd = {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  name: "HardwareVisualizer",
  applicationCategory: "UtilitiesApplication",
  operatingSystem: "Windows 10, Windows 11, Linux",
  url: "https://hardviz.com/ja/",
  downloadUrl: "https://github.com/shm11C3/HardwareVisualizer/releases",
  softwareVersion: release.version,
  description:
    "CPU温度・GPU使用率・メモリをリアルタイムで監視する無料の軽量オープンソースハードウェアモニタリングツール。美しいグラフでシステムパフォーマンスを追跡。",
  featureList: [
    "CPU使用率・温度・周波数のリアルタイムモニタリング",
    "GPU温度・使用率・VRAMの追跡",
    "メモリ使用量の分析",
    "30日間の履歴データとトレンド可視化",
    "高負荷プロセスの特定と追跡",
    "カスタム壁紙対応のダッシュボード",
    "Tauri/Rust製の超軽量アーキテクチャ",
  ],
  screenshot: "https://hardviz.com/screenshots/slide-1.png",
  author: {
    "@type": "Person",
    name: "shm11C3",
    url: "https://github.com/shm11C3",
  },
  offers: {
    "@type": "Offer",
    price: "0",
    priceCurrency: "JPY",
  },
  license: "https://opensource.org/licenses/MIT",
};
---

<Layout
  title="HardwareVisualizer - 無料の軽量CPU・GPU・メモリモニター | Windows/Linux対応"
  lang={lang}
  description="CPU温度・GPU使用率・メモリをリアルタイムで監視する無料オープンソースツール。タスクマネージャーやHWiNFOの軽量代替として最適。ゲーム中のパフォーマンス監視にも。"
  jsonLd={softwareJsonLd}
>
  <Header />
  <main>
    <Hero />
    <Screenshots />
    <Usage />
    <Insights />
    <Features />
    <Download
      client:load
      downloads={downloads}
      latestVersion={release.version}
      translations={downloadTranslations}
    />
    <FAQPreview />
  </main>
  <Footer />
</Layout>
